<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu - It's Delicious</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="menu.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        #navbar{
            background-color: black;
            color: white;
        }
    </style>
</head>
<body>
    <div id="navbar"></div>
    <div class="container menu-container">
        <div class="menu-category">
            <h2>Appetizers</h2>
            <div class="row">
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/bruschetta.jpg" class="card-img-top" alt="Bruschetta">
                        <div class="card-body">
                            <h5 class="card-title">Bruschetta</h5>
                            <p class="card-text">Grilled bread topped with a mixture of fresh tomatoes, garlic, basil, and olive oil.</p>
                            <div class="card-price">₹573.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Bruschetta" data-price="573.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/caprese-salad.jpg" class="card-img-top" alt="Caprese Salad">
                        <div class="card-body">
                            <h5 class="card-title">Caprese Salad</h5>
                            <p class="card-text">Fresh mozzarella, tomatoes, and basil drizzled with balsamic reduction and olive oil.</p>
                            <div class="card-price">₹737.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Caprese Salad" data-price="737.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/stuffed-mushroom.jpg" class="card-img-top" alt="Stuffed Mushrooms">
                        <div class="card-body">
                            <h5 class="card-title">Stuffed Mushrooms</h5>
                            <p class="card-text">Mushrooms stuffed with a savory blend of cheese, garlic, and herbs.</p>
                            <div class="card-price">₹655.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Stuffed Mushrooms" data-price="655.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="menu-category">
            <h2>Main Courses</h2>
            <div class="row">
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/margherita-pizza.jpg" class="card-img-top" alt="Margherita Pizza">
                        <div class="card-body">
                            <h5 class="card-title">Margherita Pizza</h5>
                            <p class="card-text">Classic pizza with tomatoes, fresh mozzarella, and basil.</p>
                            <div class="card-price">₹1,065.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Margherita Pizza" data-price="1065.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/spaghetti-carbonara.jpg" class="card-img-top" alt="Spaghetti Carbonara">
                        <div class="card-body">
                            <h5 class="card-title">Spaghetti Carbonara</h5>
                            <p class="card-text">Spaghetti pasta tossed with eggs, pecorino cheese, pancetta, and black pepper.</p>
                            <div class="card-price">₹1,229.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Spaghetti Carbonara" data-price="1229.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/lasagna-bolognese.jpg" class="card-img-top" alt="Lasagna Bolognese">
                        <div class="card-body">
                            <h5 class="card-title">Lasagna Bolognese</h5>
                            <p class="card-text">Layers of pasta, Bolognese sauce, béchamel, and Parmesan cheese.</p>
                            <div class="card-price">₹1,393.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Lasagna Bolognese" data-price="1393.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="menu-category">
            <h2>Desserts</h2>
            <div class="row">
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/tiramisu.jpg" class="card-img-top" alt="Tiramisu">
                        <div class="card-body">
                            <h5 class="card-title">Tiramisu</h5>
                            <p class="card-text">Layered dessert with coffee-soaked ladyfingers, mascarpone cheese, and cocoa powder.</p>
                            <div class="card-price">₹573.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Tiramisu" data-price="573.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/panna-cotta.jpg" class="card-img-top" alt="Panna Cotta">
                        <div class="card-body">
                            <h5 class="card-title">Panna Cotta</h5>
                            <p class="card-text">Creamy, silky dessert topped with a berry sauce.</p>
                            <div class="card-price">₹491.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Panna Cotta" data-price="491.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 menu-item">
                    <div class="card">
                        <img src="images/cannoli.jpg" class="card-img-top" alt="Cannoli">
                        <div class="card-body">
                            <h5 class="card-title">Cannoli</h5>
                            <p class="card-text">Crispy pastry shells filled with sweet ricotta cheese and chocolate chips.</p>
                            <div class="card-price">₹409.18</div>
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control quantity-input" value="1" min="1">
                                <button class="btn btn-primary ml-3 add-to-cart" data-item="Cannoli" data-price="409.18">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="cartModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cartModalLabel">Cart</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Item</th>
                                <th scope="col">Quantity</th>
                                <th scope="col">Price</th>
                                <th scope="col">Total</th>
                            </tr>
                        </thead>
                        <tbody id="cartItems">
                           
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-right">Total:</td>
                                <td id="cartTotal">0.00</td>
                            </tr>
                        </tfoot>
                    </table>
                    <h5>Customer Details</h5>
                    <div class="form-group">
                        <label for="customerName">Name:</label>
                        <input type="text" class="form-control" id="customerName" required>
                    </div>
                    <div class="form-group">
                        <label for="customerPhone">Phone:</label>
                        <input type="text" class="form-control" id="customerPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="customerAddress">Address:</label>
                        <textarea class="form-control" id="customerAddress" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="orderButton">Place Order</button>
                </div>
            </div>
        </div>
    </div>

    <button type="button" class="btn btn-primary corner" data-toggle="modal" data-target="#cartModal">
        Cart
    </button>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // Load the navbar
        fetch('navbar.html')
          .then(response => response.text())
          .then(data => {
            document.getElementById('navbar').innerHTML = data;
          });
    </script>
    <script>
        $(document).ready(function() {
            var cart = [];

            function renderCart() {
                var cartItems = $('#cartItems');
                cartItems.empty();
                var total = 0;
                cart.forEach(function(item) {
                    var itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    cartItems.append(`
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.quantity}</td>
                            <td>₹${item.price.toFixed(2)}</td>
                            <td>₹${itemTotal.toFixed(2)}</td>
                        </tr>
                    `);
                });
                $('#cartTotal').text(total.toFixed(2));
            }

            $('.add-to-cart').click(function() {
                var itemName = $(this).data('item');
                var price = parseFloat($(this).data('price'));
                var quantity = parseInt($(this).siblings('input.quantity-input').val());

                var existingItem = cart.find(item => item.name === itemName);
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({ name: itemName, price: price, quantity: quantity });
                }
                alert('Item added to cart successfully');
            });

            $('#cartModal').on('show.bs.modal', function() {
                renderCart();
            });

            $('#orderButton').click(function() {
                var customerName = $('#customerName').val();
                var customerPhone = $('#customerPhone').val();
                var customerAddress = $('#customerAddress').val();

                if (customerName && customerPhone && customerAddress) {
                    var orderDetails = {
                        customer_name: customerName,
                        customer_phone: customerPhone,
                        customer_address: customerAddress,
                        order_items: JSON.stringify(cart)  
                    };

                    $.ajax({
                        url: 'add_to_cart.php',  
                        method: 'POST',
                        data: orderDetails,
                        success: function(response) {
                            var result = JSON.parse(response);
                            if (result.success) {
                                alert('Order placed successfully!');
                                cart = [];
                                $('#cartModal').modal('hide');
                            } else {
                                alert('There was an error placing the order: ' + result.message);
                            }
                        },
                        error: function() {
                            alert('There was an error placing the order. Please try again.');
                        }
                    });
                } else {
                    alert('Please fill in all the details.');
                }
            });
        });
    </script>

</body>
</html>
